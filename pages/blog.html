<!DOCTYPE html>
<html lang="en" dir="ltr" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate="blog.page_title">Blog - Polban</title>
    <link rel="stylesheet" href="../src/css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;600;700&family=IRANSansX:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- 
      Font Awesome 6.4.0 from Cloudflare CDN
      SRI hash verified on 29 October 2025
      
      Security: Subresource Integrity (SRI) protects against CDN compromise
      If hash verification fails, the resource will not load
      
      To update Font Awesome:
      1. Change version in URL
      2. Get new SRI hash from https://cdnjs.com/libraries/font-awesome
      3. Update integrity attribute
      4. Test thoroughly
    -->
    <link rel="stylesheet" 
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
          integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
          crossorigin="anonymous"
          referrerpolicy="no-referrer">
    <link rel="stylesheet" href="../src/css/rtl.css" media="screen and (dir: rtl)">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XXXXXXXXXX');
    </script>
</head>
<body>
    <header>
        <nav class="container">
            <a href="../index.html" class="logo-container">
                <img src="../assets/images/logo-light.png" alt="Polban" loading="eager" width="40" height="40" class="logo-light">
                <img src="../assets/images/logo-dark.png" alt="Polban" loading="eager" width="40" height="40" class="logo-dark">
                <div class="logo-text" aria-label="Polban logo">Polban</div>
            </a>
            <ul class="nav-links" id="navLinks">
                <li><a href="../index.html#features" data-translate="navigation.features">Features</a></li>
                <li><a href="../index.html#about" data-translate="navigation.about">About</a></li>
                <li><a href="../index.html#gallery" data-translate="navigation.gallery">Gallery</a></li>
                <li><a href="../index.html#faq" data-translate="navigation.faq">FAQ</a></li>
                <li><a href="contact.html" data-translate="navigation.contact">Contact</a></li>
                <li><a href="../index.html#download" data-translate="navigation.download">Download</a></li>
                <li><a href="blog.html" class="active" data-translate="navigation.blog">Blog</a></li>
            </ul>
            <div class="header-actions">
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="hamburger" id="hamburger" aria-label="Toggle navigation menu">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </nav>
    </header>

    <main id="main-content">
        <section class="blog-header container">
            <h1 data-translate="blog.header.title">Polban Blog</h1>
            <p data-translate="blog.header.subtitle">Tips, articles, and updates on financial management.</p>
        </section>

        <div class="container">
            <!-- View Toggle Controls -->
            <div class="blog-view-controls">
                <button class="view-btn active" id="gridViewBtn" data-view="grid" aria-label="Grid view">
                    <i class="fas fa-th" aria-hidden="true"></i>
                    <span data-translate="blog.view_toggle.grid">Grid View</span>
                </button>
                <button class="view-btn" id="listViewBtn" data-view="list" aria-label="List view">
                    <i class="fas fa-list" aria-hidden="true"></i>
                    <span data-translate="blog.view_toggle.list">List View</span>
                </button>
            </div>

            <section class="blog-posts blog-grid" id="blog-posts-container">
                <!-- Blog posts will be dynamically loaded here -->
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <p data-translate="footer.copyright">&copy; 2025 Polban. All rights reserved.</p>
            <div class="footer-links">
                <a href="privacy.html" data-translate="footer.privacy">Privacy Policy</a>
                <a href="terms.html" data-translate="footer.terms">Terms of Service</a>
            </div>
        </div>
    </footer>

    <script src="../src/js/localization.js"></script>
    <script>
    // Initialize localization system for blog page
    async function initLocalizationForPage() {
        try {
            await initPolbanLocalization({
                basePath: '../src/locales/',
                autoCreateSwitcher: true
            });

            // Render blog posts after localization is ready
            renderBlogPosts();

            // Re-render blog posts when language changes
            document.addEventListener('languageChanged', function(e) {
                renderBlogPosts();
            });
        } catch (error) {
            console.error('Failed to initialize localization:', error);
        }
    }

    function renderBlogPosts() {
        const container = document.getElementById('blog-posts-container');
        if (!container || !window.localizationManager) return;

        const posts = window.localizationManager.getTranslation('blog.posts');
        const readMoreText = window.localizationManager.getTranslation('blog.post_card.read_more');
        const postedOnText = window.localizationManager.getTranslation('blog.post_card.posted_on');
        const byAuthorText = window.localizationManager.getTranslation('blog.post_card.by_author');

        // Map post indices to their actual blog URLs
        const postUrls = [
            'blog/budgeting-tips.html',
            'blog/travel-expenses.html',
            'blog/multi-currency-guide.html',
            'blog/categorization-best-practices.html'
        ];

        if (posts && Array.isArray(posts) && posts.length > 0) {
            container.innerHTML = posts.map((post, index) => `
                <article class="post-card">
                    <div class="post-image">
                        <img src="../assets/images/gallery-${(index % 6) + 1}.webp" alt="${post.title}" loading="lazy">
                    </div>
                    <div class="post-content">
                        <h2><a href="${postUrls[index]}">${post.title}</a></h2>
                        <div class="post-meta">
                            <span class="post-date"><i class="fas fa-calendar-alt"></i> ${postedOnText} ${post.date}</span>
                            <span class="post-author"><i class="fas fa-user"></i> ${byAuthorText} ${post.author}</span>
                        </div>
                        <p>${post.description}</p>
                        <a href="${postUrls[index]}" class="btn primary">${readMoreText}</a>
                    </div>
                </article>
            `).join('');
        } else {
            const noPosts = window.localizationManager.getTranslation('blog.no_posts');
            const comingSoon = window.localizationManager.getTranslation('blog.coming_soon');
            container.innerHTML = `
                <div class="no-posts">
                    <p>${noPosts}</p>
                    <p>${comingSoon}</p>
                </div>
            `;
        }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initLocalizationForPage);
    } else {
        initLocalizationForPage();
    }

    // Blog view switching functionality
    function initBlogViewToggle() {
        const gridViewBtn = document.getElementById('gridViewBtn');
        const listViewBtn = document.getElementById('listViewBtn');
        const blogContainer = document.getElementById('blog-posts-container');

        if (!gridViewBtn || !listViewBtn || !blogContainer) return;

        // Load saved view preference from localStorage
        const savedView = localStorage.getItem('blogView') || 'grid';
        applyView(savedView);

        // Add click handlers
        gridViewBtn.addEventListener('click', function() {
            applyView('grid');
            localStorage.setItem('blogView', 'grid');
        });

        listViewBtn.addEventListener('click', function() {
            applyView('list');
            localStorage.setItem('blogView', 'list');
        });

        function applyView(view) {
            if (view === 'grid') {
                blogContainer.classList.remove('blog-list');
                blogContainer.classList.add('blog-grid');
                gridViewBtn.classList.add('active');
                listViewBtn.classList.remove('active');
            } else {
                blogContainer.classList.remove('blog-grid');
                blogContainer.classList.add('blog-list');
                listViewBtn.classList.add('active');
                gridViewBtn.classList.remove('active');
            }
        }
    }

    // Initialize view toggle after DOM is loaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initBlogViewToggle);
    } else {
        initBlogViewToggle();
    }
    </script>
    <script src="../src/js/script.js"></script>
</body>
</html>
